# SPb Realty Mining

Если вы хотите снять квартиру в Петербурге, то неплохо бы сначала посмотреть что происходит 
с рынком недвижимости. Обычно большинство объявлений публикуются в общей базе 
[pin7.ru](https://pin7.ru) и агентства скорее всего будут предлагать вам варианты оттуда.

Превратить текущий снимок этой базы в удобную для анализа CSV или показать актуальные
на текущий момент статистики по рынку и призван SPb Realty Mining.

_Для установки и работы требуется Python 3.5+_

### Установка
Для начала нужно склонировать репозиторий и установить зависимости:
```bash
git clone git@github.com:anatoly-chichikov/spb-realty-mining.git
cd spb-realty-mining
pip install -r requirements.txt
```

### Сбор
Далее собираем данные. Для этого необходимо получить вашу персональную сессию.
- залогиниться в pin7 под вашим агентством или 
[общедоступным паролем](http://pin7-kod.ru/rukovodstvo-k-pin7-ru/)
- после логина нужно кликнуть `Cмотреть Базу`
- в инспекторе браузера найти cookies у запроса `https://pin7.ru/online.php`, 
например: `Cookie: pcode=imvcn7cdnsrqqm0crsl4ubkpp1`
- получить значение cookie `pcode`
- начать сбор и дождаться окончания (~10 минут)
```bash
python3 -m realty --task gather --cookie imvcn7cdnsrqqm0crsl4ubkpp1
```

### Обработка
После сбора генерим нашу CSV - `data.csv`. Теперь можете самостоятельно фильтровать предложения
и отправить их id своему агенту. 
```bash
python3 -m realty --task transform
```

### Статистики
Если имеется готовая CSV, можно посмотреть основные статистики по рынку:
```bash
python3 -m realty --task stats
```
Результат будет примерно следующий:
```
АРЕНДА В САНКТ-ПЕТЕРБУРГЕ
======================================>>>
> Общая информация:
===> Всего предложений - 12 557 квартир
===> Комнаты - 2 374 квартир, 18.91%
===> Однокомнатные и студии - 4 246 квартир, 33.81%
===> Двухкомнатные - 3 392 квартир, 27.01%
===> Три и более комнат - 2 420 квартир, 19.27%
===> В новостройках - 3 299 квартир
===> С хорошим ремонтом - 5 699 квартир
===> Можно с детьми - 11 948 квартир
===> Можно с животными - 791 квартир
======================================>>>
> Цена:
===> Минимально возможная цена - 1 000 ₽/мес
===> Максимальная цена - 1 150 000 ₽/мес
===> Средняя цена - 39 230 ₽/мес
===> Половина предложений дешевле - 25 000 ₽/мес
===> Большая часть (90%) дешевле - 80 000 ₽/мес
===> Большая часть (90%) дороже - 10 500 ₽/мес
======================================>>>
> Площадь:
===> Минимально возможная площадь - 6.0 кв.м.
===> Максимальная площадь - 560.0 кв.м.
===> Средняя площадь - 56.39 кв.м.
===> Половина предложений меньше - 45.0 кв.м.
===> Большая часть (90%) меньше - 103.4 кв.м.
===> Большая часть (90%) больше - 15.0 кв.м.
======================================>>>
> Районы:
===> Самые дорогие - Петроградский, Центральный, Адмиралтейский
===> Самые дешевые - Кировский, Калининский, Невский
===> Больше с хорошим ремонтом - Центральный, Приморский, Выборгский
===> Меньше с хорошим ремонтом - Фрунзенский, Кировский, Красногвардейский
===> Больше заселяют с детьми - Центральный, Приморский, Выборгский
===> Меньше заселяют с детьми - Красногвардейский, Фрунзенский, Адмиралтейский
===> Больше допускают животных - Калининский, Приморский, Выборгский
===> Меньше допускают животных - Адмиралтейский, Фрунзенский, Петроградский
```
